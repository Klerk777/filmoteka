{"mappings":"gfAAAA,EAAA,S,2CAKA,MAAMC,EAAaC,OAAOC,SAASC,KAEnC,IAAIC,EAAO,KAEX,MAAMC,EAAO,CACXC,WAAYC,SAASC,cAAc,iBACnCC,SAAUF,SAASC,cAAc,eACjCE,cAAeH,SAASC,cAAc,aAyBxCG,eAAeC,IACbC,EAAUR,EAAKC,YACfQ,EAAYT,EAAKI,UACjB,MAAMM,QAAgB,EAAAC,EAAAC,oBAAmBb,EAAKc,KAC9CC,EAAoBC,OAAOC,OAAON,GAASO,KAAIC,GAASA,EAAM,OAChE,CASA,SAAST,EAAYU,GACnBA,EAAGC,UAAUC,OAAO,uBACtB,CAEA,SAASb,EAAUW,GACjBA,EAAGC,UAAUE,IAAI,uBACnB,CAEA,SAASR,EAAoBS,GAC3BvB,EAAKK,cAAcmB,WAAY,EAAAC,EAAAC,SAAaH,EAC9C,EAnCAjB,iBACEP,QAAa,EAAA4B,EAAAC,eACTjC,EAAWkC,SAAS,gBACjB9B,IACHH,OAAOC,SAASC,KAAO,iBAGzBS,IAEJ,CApBAuB,GAEA9B,EAAKC,WAAW8B,iBAAiB,QAASxB,GAC1CP,EAAKI,SAAS2B,iBAAiB,SA0B/BzB,iBACEE,EAAUR,EAAKI,UACfK,EAAYT,EAAKC,YACjB,MAAM+B,QAAe,EAAArB,EAAAsB,kBAAiBlC,EAAKc,KAC3CC,EAAoBC,OAAOC,OAAOgB,GAAQf,KAAIiB,GAASA,EAAM,OAC/D,G","sources":["src/js/my-library.js"],"sourcesContent":["import './pagination';\nimport { currentUser } from './api-service/firebase-api-auth';\nimport { getWatchedByUserId, getQueueByUserId } from './api-service/firebase-api-database';\nimport filmsCardTpl from '../templates/card-films.hbs';\n\nconst currentUrl = window.location.href;\n\nlet user = null;\n\nconst refs = {\n  btnWatched: document.querySelector('#btn__watched'),\n  btnQueue: document.querySelector('#btn__queue'),\n  containerList: document.querySelector('.js-card'),\n};\n\nstatus();\n\nrefs.btnWatched.addEventListener('click', onWatched);\nrefs.btnQueue.addEventListener('click', onQueue);\n\n// if (currentUrl.includes('my-library')) {\n//   if (!getUid()) {\n//     //window.location.href = '../auth/signin.html';\n//   }\n// }\n\nasync function status() {\n  user = await currentUser();\n  if (currentUrl.includes('my-library')) {\n    if (!user) {\n      window.location.href = './signin.html';\n    }\n\n    onWatched();\n  }\n}\n\nasync function onWatched() {\n  activeBtn(refs.btnWatched);\n  inactiveBtn(refs.btnQueue);\n  const watches = await getWatchedByUserId(user.uid);\n  appendResultsMarkup(Object.values(watches).map(watch => watch['film']));\n}\n\nasync function onQueue() {\n  activeBtn(refs.btnQueue);\n  inactiveBtn(refs.btnWatched);\n  const queues = await getQueueByUserId(user.uid);\n  appendResultsMarkup(Object.values(queues).map(queue => queue['film']));\n}\n\nfunction inactiveBtn(bt) {\n  bt.classList.remove('btn__library--active');\n}\n\nfunction activeBtn(bt) {\n  bt.classList.add('btn__library--active');\n}\n\nfunction appendResultsMarkup(results) {\n  refs.containerList.innerHTML = filmsCardTpl(results);\n}\n"],"names":["parcelRequire","$bb2af86579234925$var$currentUrl","window","location","href","$bb2af86579234925$var$user","$bb2af86579234925$var$refs","btnWatched","document","querySelector","btnQueue","containerList","async","$bb2af86579234925$var$onWatched","$bb2af86579234925$var$activeBtn","$bb2af86579234925$var$inactiveBtn","watches","$cqQ1z","getWatchedByUserId","uid","$bb2af86579234925$var$appendResultsMarkup","Object","values","map","watch","bt","classList","remove","add","results","innerHTML","$2qgW3","default","$bZgM4","currentUser","includes","$bb2af86579234925$var$status","addEventListener","queues","getQueueByUserId","queue"],"version":3,"file":"my-library.f3b54070.js.map"}